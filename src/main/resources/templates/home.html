<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<head>
    <meta charset="UTF-8">
    <title>Home</title>
</head>
<div th:replace="fragments/header.html :: header">&nbsp;</div>
<body class="container">
<div class="row">
    <div class="col-5 border" >
        <p class="display-4">Financial Search</p>
        <p>Previous tickers searched</p>
        <div class="bg-dark text-white m-1 col-2 text-center" th:each="symbol: ${userSettings}">
            <a th:text="${symbol.getTicker()}"></a>
        </div>
        <form action="#" method="post" th:action="@{/user/home}" th:object="${stockDataRequestForm}">
            <span class="text-danger" th:if="${#fields.hasGlobalErrors()}">Global error</span><br/>
            <input class="m-1 text-center" placeholder="Ticker 'UEC'" th:field="*{ticker}" type="text"/>
            <span class="text-danger" th:errors="*{ticker}"
                  th:if="${#fields.hasErrors('ticker')}">Ticker error</span><br/>
            <input class="m-1 text-center" placeholder="Interval 'SIXTY_MIN'" th:field="*{interval}" type="text"/>
            <span class="text-danger" th:errors="*{interval}"
                  th:if="${#fields.hasErrors('interval')}">Interval error</span><br/>
            <button class="btn m-1" type="submit">Request Data</button>
        </form>
    </div>
</div>
<div class="row pt-4">
    <div class="col-5 border" th:if="${backTraderForm != null}">
        <p class="display-4">BackTester</p>
        <form action="#" method="post" th:action="@{/user/home/backtrade}" th:object="${backTraderForm}">
            <span class="text-danger" th:if="${#fields.hasGlobalErrors()}">Global error</span><br/>
            <input class="m-1 text-center" placeholder="9/21/2007" th:field="*{startDate}" type="text"/>
            <span class="text-danger" th:errors="*{startDate}"
                  th:if="${#fields.hasErrors('startDate')}">Start Date Error</span><br/>
            <input class="m-1 text-center" placeholder="9/21/2023" th:field="*{endDate}" type="text"/>
            <span class="text-danger" th:errors="*{endDate}"
                  th:if="${#fields.hasErrors('endDate')}">End Date Error</span><br/>
            <input class="m-1 text-center" placeholder="Ticker 'EOG'" th:field="*{stockTicker}" type="text"/>
            <span class="text-danger" th:errors="*{stockTicker}"
                  th:if="${#fields.hasErrors('stockTicker')}">Ticker error</span><br/>
            <input class="m-1 text-center" placeholder="SMAEMACross" th:field="*{algorithm}" type="text"/>
            <span class="text-danger" th:errors="*{algorithm}"
                  th:if="${#fields.hasErrors('algorithm')}">Algorithm error</span><br/>
            <input class="m-1 text-center" placeholder=".3" th:field="*{stake}" type="text"/>
            <span class="text-danger" th:errors="*{stake}"
                  th:if="${#fields.hasErrors('stake')}">Stake error</span><br/>
            <input class="m-1 text-center" placeholder=".01" th:field="*{commission}" type="text"/>
            <span class="text-danger" th:errors="*{commission}"
                  th:if="${#fields.hasErrors('commission')}">Commission error</span><br/>
            <input class="m-1 text-center" placeholder="30" th:field="*{smaLength}" type="text"/>
            <span class="text-danger" th:errors="*{smaLength}"
                  th:if="${#fields.hasErrors('smaLength')}">SmaLength error</span><br/>
            <input class="m-1 text-center" placeholder="15" th:field="*{emaLength}" type="text"/>
            <span class="text-danger" th:errors="*{emaLength}"
                  th:if="${#fields.hasErrors('emaLength')}">EmaLength error</span><br/>
            <button class="btn m-1" type="submit">Test Params</button>
        </form>
    </div>
    <div th:if="${backtrader != null}">
        <p th:each="*{backtrader}" th:valuetype="*{backtrader.keySet()}" th:value="*{backtrader.values()}"></p>
    </div>
</div>
<div class="row pt-4">
    <div class="col-5 border" th:if="${backTraderOptimizeForm != null}">
        <p class="display-4">Optimizer</p>
        <form action="#" method="post" th:action="@{/user/home/backtradeOpt}" th:object="${backTraderOptimizeForm}">
            <span class="text-danger" th:if="${#fields.hasGlobalErrors()}">Global error</span><br/>
            <input class="m-1 text-center" placeholder="9/21/2007" th:field="*{startDate}" type="text"/>
            <span class="text-danger" th:errors="*{startDate}"
                  th:if="${#fields.hasErrors('startDate')}">Start Date Error</span><br/>
            <input class="m-1 text-center" placeholder="9/21/2023" th:field="*{endDate}" type="text"/>
            <span class="text-danger" th:errors="*{endDate}"
                  th:if="${#fields.hasErrors('endDate')}">End Date Error</span><br/>

            <label for="stockTicker">Choose a ticker:</label>
            <select class="form-control" id="stockTicker" name="selectedStockTicker">
                <option th:each="stockTicker :${StockTicker.getEnumConstants()}" th:value="${stockTicker}" th:text="${stockTicker}">Option</option>
            </select>

            <label for="algorithm">Choose an Algorithm:</label>
            <select class="form-control" id="algorithm" name="selectedAlgorithm">
                <option th:each="algorithm :${Algorithm.getEnumConstants()}" th:value="${algorithm}" th:text="${algorithm}">Option</option>
            </select>

            <input class="m-1 text-center" placeholder=".3" th:field="*{stake}" type="text"/>
            <span class="text-danger" th:errors="*{stake}"
                  th:if="${#fields.hasErrors('stake')}">Stake error</span><br/>
            <input class="m-1 text-center" placeholder=".01" th:field="*{commission}" type="text"/>
            <span class="text-danger" th:errors="*{commission}"
                  th:if="${#fields.hasErrors('commission')}">Commission error</span><br/>
            <input class="m-1 text-center" placeholder="40" th:field="*{smaOptChange}" type="text"/>
            <span class="text-danger" th:errors="*{smaOptChange}"
                  th:if="${#fields.hasErrors('smaOptChange')}">Sma difference error</span><br/>
            <input class="m-1 text-center" placeholder="30" th:field="*{emaOptChange}" type="text"/>
            <span class="text-danger" th:errors="*{emaOptChange}"
                  th:if="${#fields.hasErrors('emaOptChange')}">Ema difference error</span><br/>
            <button class="btn m-1" type="submit">Optimize Params</button>
        </form>
    </div>
    <div th:if="${backtraderOpt != null}">
        <p th:each="*{backtraderOpt}" th:valuetype="*{backtraderOpt.keySet()}" th:value="*{backtraderOpt.values()}"></p>
    </div>
</div>
</body>
</html>